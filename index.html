<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <!-- https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self' 'unsafe-inline'; script-src 'unsafe-eval' 'self' 'unsafe-inline';img-src  data: ;"
    />
    <!-- <script src="./UI.js"></script> -->
    <!-- <script src="./UI.zh-Hant.js"></script> -->
    <script>
      window.$ = window.jQuery = require("jquery");
      require("bootstrap");
      require("@popperjs/core");
    </script>
    <script src="./UI.js"></script>

    <script src="./renderUI.js"></script>
    <script src="./functions.js"></script>
    <!-- <script>
      const webview = document.querySelector("webview");
      webview.addEventListener("found-in-page", (e) => {
        webview.stopFindInPage("keepSelection");
      });

      const requestId = webview.findInPage("test");
      console.log(requestId);
    </script> -->
    <link
      rel="stylesheet"
      href="./node_modules/bootstrap/dist/css/bootstrap.css"
    />

    <style>
      @import url("./res/HarmonyOS_Sans_TC/stylesheet.css");

      * {
        font-family: HarmonyOS Sans TC;
      }
      body{
        overflow-y: scroll;
      }
      /* #settings-operations #web {
        height: calc(100vh - 40px);
      } */
      
    </style>

    <title>Easy ADB and fastboot</title>
  </head>

  <body>
    <!-- Button trigger modal -->
    <div id="autoHideScrollBar"></div>
    <!-- Modal -->
    <div
      class="modal fade"
      data-bs-backdrop="static"
      id="manage-devices"
      tabindex="-1"
      role="dialog"
      aria-labelledby="modal-title"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Select devices (by S/N)</h5>
            <button
              type="button"
              class="btn-close"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body d-flex justify-content-center flex-column">
            <button
              type="button"
              class="btn btn-primary align-self-center col-2"
              onclick="refreshDevices()"
            >
              Refresh
            </button>
            <div
              id="deviceList"
              class="d-flex justify-content-center flex-column"
            ></div>
          </div>
          <div class="modal-footer justify-content-between">
            <button
              type="button"
              class="btn btn-secondary"
              onclick="selectedDevices=[]"
            >
              Clear queue
            </button>

            <button
              type="button"
              class="btn btn-primary"
              onclick="selectDevice(foundDevices)"
              data-bs-dismiss="modal"
            >
              Save
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="container alerts">
      <div id="alertDiv"></div>
    </div>
    <ul class="nav justify-content-center" id="navbar"></ul>
    <div id="topButtons" class="container d-flex justify-content-center">
      <button
        type="button"
        id="devicesSelector-btn"
        class="btn btn-primary mb-2"
        data-bs-toggle="modal"
        data-bs-target="#manage-devices"
        onclick="refreshDevices();"
      >
        Select devices
      </button>
      <button
        id="refreshSettings"
        class="btn btn-primary mb-2"
        onclick="document.getElementById('web').reload()"
      >
        Refresh Settings
      </button>
    </div>
  </body>
  <script>
    $(document).ready(function () {
      function createWebview(id, url) {
        //creates a webview with the id of the tab and the url loaded
        let webview = document.createElement("webview");
        webview.setAttribute("id", id);
        webview.setAttribute("src", url);
        webview.setAttribute("nodeintegration", "");
        webview.setAttribute("webpreferences", "contextIsolation=false");
        webview.addEventListener("dom-ready", () => {
          webview.openDevTools();
        });
        console.log(webview);
        return webview;
      }
      const settingsWeb = document
        .querySelector("#settings-operations")
        .appendChild(
          createWebview("web", `file://${__dirname}/settings/settings.html`)
        );
      // $('#web').css('width', '100%');
      console.log(`calc(100vh-${$("#navbar").css("height")})`);
    });
  </script>
</html>
